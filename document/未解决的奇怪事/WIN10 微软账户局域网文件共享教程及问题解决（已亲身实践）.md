# WIN10 微软账户局域网文件共享教程及问题解决（已亲身实践）

 2020-04-05 







——

## 前言

今天闲着没事想把手头的笔记本和房间里的台式组个局域网文件共享，想不到这么简单的事居然搞了一个上午，还走了不少弯路，网络上各种各样的教程还不是给所有人都适用的。

> 部分图源引自网络，因为本人的文件共享已配置成功，因此不能复现文章部分内容。

## 0 准备就绪

本文仅适用于满足以下条件的电脑：

1. 用于文件共享的电脑处于同一局域网内
2. window10
3. 本机账户为微软账户(本地账户也可，但是不如微软账户简单，参照 **尝试解决1** ）

至于为什么这样要求，是因为不同版本的win10和不同权限的账户进行文件共享的操作都不同*，具体请看下文。

### 0.1 PC 的win10版本

一些教程可能会让你设置诸如“本地用户和组“、“组策略”等，但是请注意并非所有的装载win10系统的电脑都能运行这些功能，请看下图：
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404174105710.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI2MzYyNg==,size_16,color_FFFFFF,t_70)

> 家庭版的企业特性基本功能少的可怜，远程桌面也被阉割了。

我手上的笔记本预装家庭中文版，台式机为专业版，因此采取的配置策略完全不同。这些功能虽然在日常工作和家庭娱乐不会用到，涉及企业配置时却非常重要，微软还真是精明啊，企业用户和家庭用户分别收割，互不干扰，大家都心甘情愿掏钱。

要注意低端版本是可以通过特殊方法启用这些高级功能，但这些更改在win10的频繁更新以后有很大可能被还原失效，建议还是通过合规的方式进行文件共享。

### 账户

简单来讲账户有两种，一种是Mircosoft账户（网络账户，**一般是邮箱形式**），一种是本地账户，这两类账号的文件共享配置方式也是不同的！
百度里的各种教程基本上是针对本地账户的，但是对于登陆了Microsoft账户的电脑，当在网络中访问该电脑时，你可能会发现即便已经添加Windows凭据，并且输入了正确用户名和密码，仍然显示用户名和密码错误。
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404175812224.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI2MzYyNg==,size_16,color_FFFFFF,t_70)
正确方法应该是**在用户名栏填入微软账户，密码栏填入微软账户密码**，这样就能进入了。
**在使用微软账户的情况下没有必要添加windows凭据。**

> 一些教程提示在用户名栏填入类似 a\administrator 这样的格式来通过验证，但是在登录微软账户的情况下这种方法是无效的。

> 本地账户通常有四种：（第一个账户原名称：administrator）
> ![这里是引用](https://i2.wp.com/img-blog.csdnimg.cn/20200404192734855.png)

## 文件共享步骤

1.在【网络和Internet】-【状态】-【更改网络设置】中点击【共享选项】，弹出以下界面：
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404185922803.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI2MzYyNg==,size_16,color_FFFFFF,t_70)
在【专用（当前文件配置）】中打开“启用网络发现”，启用”文件和打印机共享“。
打开【所有网络】，勾选“关闭密码保护共享”，点击【保存更改】。

2.接下来需要对需要被共享的文件夹进行文件共享。这一块网络上有很多教程，基本都是对的。
在被共享文件夹【属性】-【共享标签】-【共享】中添加**微软用户**，点击【共享】，等待完成；在高级共享中勾选“**共享此文件夹**”，点击【权限】，添加“**everyone**”

理论上到这一步文件已成功共享。
配置完成后，点击被访问的电脑，在弹出的【输入网络凭据】框中输入微软账户和密码，可访问共享文件。

## 问题突发

现在这两台电脑都没有添加任何windows凭据或新建本地账户（比如教程里常见的建立guest账户），也没有映射网络驱动器，仅配置上述步骤。
经测试发现当专业版访问家庭版时，提示输入凭据，输入微软账户密码后验证通过可自由访问家庭版内的共享文件；但是当家庭版访问专业版时，没有提示输入凭据，反而显示错误：
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404181049263.png)
？？？
于是我又打开了被共享文件夹【属性】-【共享标签】-【共享】，发现添加的微软账户户居然变为未知联系人了，而且奇怪的是所有者为本地账户而非微软账户。
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404201327173.png)

> 图中的everyone是采用第一种解决方法增加的。

## 尝试解决1

> 此方法也能支持两台使用**本地账户**的win10电脑实现文件共享，但是双方必须安装专业版或以上的windows版本）

于是我又去网上翻了各种各样的教程，然后找到了一种方法，这种方法要求拒绝共享文件的一方必须安装专业版或以上的windows版本。
首先进入【控制面板】将查看方式改为大图标显示，然后点击【管理工具】-【本地安全策略】如下图：
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/2020040419091150.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI2MzYyNg==,size_16,color_FFFFFF,t_70)将里面的guest删除，这是因为win10默认禁止guest进行访问（注意这个删除之后貌似添加不回来了）。这时候如果在【网络】中点击另一台电脑进行访问测试会发现可以进入界面，可以浏览【Users】文件夹，但当点击被共享的文件夹时，会发现问题仍然存在。
![在这里插入图片描述](https://i2.wp.com/img-blog.csdnimg.cn/20200404192419324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI2MzYyNg==,size_16,color_FFFFFF,t_70)
解决的办法是在被共享文件夹【属性】-【共享标签】-【共享】中添加用户**everyone**或**guest**（前者已包含后者），这样就可以解决问题，**并且不需要输入凭证**，也没有麻烦的步骤。这种方法是将访问者当作guest并授予其相应用户权限。







但是，这种解决方式得益于台式机装载了专业版系统，假如两台电脑都是家庭版，岂不是变成单工通信了；而且也不够安全，因为只要在同一个网络，访问者甚至都不需要被验证身份（不过这样一来台式反而成服务器了）。
因此我开始尝试下一种解决方式：为什么有关微软账户的设置失效了？

## 尝试解决2

> 吐槽一下微软这本地账户和微软账户界限也搞得太模糊了，明明都显示微软账户邮箱名了，在官网登微软账户也显示本账户拥有该设备，结果登的却是本地账户。

那么首先要解决为什么微软账户变成了未知联系人。
经过仔细研究，我发现台式机的账户虽然显示了邮箱，但实际上是本地账户（很多方面可以体现，比如说账号头像、名称不同，没有登陆密码，没有【改用本地账号登录】）。因此要切换成微软账户。
找了半天终于找到切换微软账户的方法：

> https://zhidao.baidu.com/question/1737748729229364827.html

问题在于当我切换成微软账户时，电脑卡在验证账户密码处，还黑屏了。

理论上来说只要能登上微软账户，就能按上述步骤实现文件共享了，但是因为这个原因我暂时无法验证。







——
*先写到这里，待我和官方技术人员讨论一下。*